try:
    import megatron.bridge  # noqa: F401

    HAVE_MEGATRON_BRIDGE = True
except ModuleNotFoundError:
    HAVE_MEGATRON_BRIDGE = False

if HAVE_MEGATRON_BRIDGE:
    from .llama3_llm_finetune import (
        llama3_8b_sft_config_gb200,
        llama3_8b_sft_config_h100,
        llama3_70b_lora_config_gb200,
        llama3_70b_lora_config_gb300,
        llama3_70b_lora_config_h100,
        llama3_70b_sft_config_gb200,
        llama3_70b_sft_config_gb300,
        llama3_70b_sft_config_h100,
    )
    from .llama3_llm_pretrain import (
        llama3_8b_pretrain_config_b200,
        llama3_8b_pretrain_config_b300,
        llama3_8b_pretrain_config_gb200,
        llama3_8b_pretrain_config_gb300,
        llama3_8b_pretrain_config_h100,
        llama3_70b_pretrain_config_b200,
        llama3_70b_pretrain_config_b300,
        llama3_70b_pretrain_config_gb200,
        llama3_70b_pretrain_config_gb300,
        llama3_70b_pretrain_config_h100,
    )
    from .llama31_llm_pretrain import (
        llama31_405b_pretrain_config_b200,
        llama31_405b_pretrain_config_b300,
        llama31_405b_pretrain_config_gb200,
        llama31_405b_pretrain_config_gb300,
        llama31_405b_pretrain_config_h100,
    )

from .llama3_workload_base_configs import (
    LLAMA3_8B_PRETRAIN_CONFIG_B200_BF16_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B200_FP8_CS_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B200_FP8_MX_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B200_NVFP4_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B300_BF16_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B300_FP8_CS_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B300_FP8_MX_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_B300_NVFP4_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB200_BF16_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB200_FP8_CS_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB200_FP8_MX_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB200_NVFP4_V1,
    # 8B Pretrain V1
    LLAMA3_8B_PRETRAIN_CONFIG_GB300_BF16_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB300_FP8_CS_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB300_FP8_MX_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_GB300_NVFP4_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_H100_BF16_V1,
    LLAMA3_8B_PRETRAIN_CONFIG_H100_FP8_CS_V1,
    # 8B SFT V1
    LLAMA3_8B_SFT_CONFIG_GB200_BF16_V1,
    LLAMA3_8B_SFT_CONFIG_GB200_FP8_CS_V1,
    LLAMA3_8B_SFT_CONFIG_GB200_FP8_MX_V1,
    LLAMA3_8B_SFT_CONFIG_H100_BF16_V1,
    LLAMA3_8B_SFT_CONFIG_H100_FP8_CS_V1,
    LLAMA3_8B_SFT_CONFIG_H100_FP8_MX_V1,
    # 70B LoRA V1
    LLAMA3_70B_LORA_CONFIG_GB200_BF16_V1,
    LLAMA3_70B_LORA_CONFIG_GB200_FP8_CS_V1,
    LLAMA3_70B_LORA_CONFIG_GB200_FP8_MX_V1,
    LLAMA3_70B_LORA_CONFIG_GB300_BF16_V1,
    LLAMA3_70B_LORA_CONFIG_GB300_FP8_CS_V1,
    LLAMA3_70B_LORA_CONFIG_GB300_FP8_MX_V1,
    LLAMA3_70B_LORA_CONFIG_H100_BF16_V1,
    LLAMA3_70B_LORA_CONFIG_H100_FP8_CS_V1,
    LLAMA3_70B_LORA_CONFIG_H100_FP8_MX_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_BF16_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_BF16_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_CS_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_CS_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_MX_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_MX_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_NVFP4_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B200_NVFP4_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_BF16_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_BF16_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_CS_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_CS_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_MX_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_MX_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_NVFP4_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_B300_NVFP4_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_BF16_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_BF16_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_CS_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_CS_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_MX_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_MX_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_NVFP4_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB200_NVFP4_V2,
    # 70B Pretrain V2 (GBS=256)
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_BF16_V1,
    # 70B Pretrain V1
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_BF16_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_CS_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_CS_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_MX_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_MX_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_NVFP4_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_GB300_NVFP4_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_H100_BF16_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_H100_BF16_V2,
    LLAMA3_70B_PRETRAIN_CONFIG_H100_FP8_CS_V1,
    LLAMA3_70B_PRETRAIN_CONFIG_H100_FP8_CS_V2,
    # 70B SFT V1
    LLAMA3_70B_SFT_CONFIG_GB200_BF16_V1,
    LLAMA3_70B_SFT_CONFIG_GB200_FP8_CS_V1,
    LLAMA3_70B_SFT_CONFIG_GB200_FP8_MX_V1,
    LLAMA3_70B_SFT_CONFIG_GB300_BF16_V1,
    LLAMA3_70B_SFT_CONFIG_GB300_FP8_CS_V1,
    LLAMA3_70B_SFT_CONFIG_GB300_FP8_MX_V1,
    LLAMA3_70B_SFT_CONFIG_H100_BF16_V1,
    LLAMA3_70B_SFT_CONFIG_H100_FP8_CS_V1,
    LLAMA3_70B_SFT_CONFIG_H100_FP8_MX_V1,
)
from .llama31_workload_base_configs import (
    # V1
    LLAMA31_405B_PRETRAIN_CONFIG_B200_BF16_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B200_FP8_CS_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B200_FP8_MX_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B200_NVFP4_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B300_BF16_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B300_FP8_CS_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B300_FP8_MX_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_B300_NVFP4_V1,
    # V2 (GB300/GB200: num_gpus=256, GBS=1536; H100: GBS=1536)
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_BF16_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_BF16_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_CS_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_CS_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_MX_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_MX_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_NVFP4_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB200_NVFP4_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_BF16_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_BF16_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_CS_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_CS_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_MX_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_MX_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_NVFP4_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_GB300_NVFP4_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_H100_BF16_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_H100_BF16_V2,
    LLAMA31_405B_PRETRAIN_CONFIG_H100_FP8_CS_V1,
    LLAMA31_405B_PRETRAIN_CONFIG_H100_FP8_CS_V2,
)


__all__ = [
    # Llama31 405B V1
    "LLAMA31_405B_PRETRAIN_CONFIG_B300_BF16_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B300_FP8_CS_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B300_FP8_MX_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B300_NVFP4_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B200_BF16_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B200_FP8_CS_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B200_FP8_MX_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_B200_NVFP4_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_BF16_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_CS_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_MX_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_NVFP4_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_BF16_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_CS_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_MX_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_NVFP4_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_H100_BF16_V2",
    "LLAMA31_405B_PRETRAIN_CONFIG_H100_FP8_CS_V2",
    # Llama31 405B V2 (GB300/GB200: num_gpus=256, GBS=1536; H100: GBS=1536)
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_BF16_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_CS_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_FP8_MX_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB200_NVFP4_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_BF16_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_CS_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_FP8_MX_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_GB300_NVFP4_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_H100_BF16_V1",
    "LLAMA31_405B_PRETRAIN_CONFIG_H100_FP8_CS_V1",
    # Llama3 70B Pretrain V1
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_BF16_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_CS_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_MX_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_NVFP4_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_BF16_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_CS_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_MX_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_NVFP4_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_BF16_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_CS_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_MX_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_NVFP4_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_BF16_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_CS_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_MX_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_NVFP4_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_H100_BF16_V2",
    "LLAMA3_70B_PRETRAIN_CONFIG_H100_FP8_CS_V2",
    # Llama3 70B Pretrain V2 (GBS=256)
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_BF16_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_CS_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_FP8_MX_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB300_NVFP4_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_BF16_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_CS_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_FP8_MX_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_GB200_NVFP4_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_BF16_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_CS_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_FP8_MX_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B300_NVFP4_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_BF16_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_CS_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_FP8_MX_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_B200_NVFP4_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_H100_BF16_V1",
    "LLAMA3_70B_PRETRAIN_CONFIG_H100_FP8_CS_V1",
    # Llama3 8B Pretrain V1
    "LLAMA3_8B_PRETRAIN_CONFIG_B300_BF16_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B300_FP8_CS_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B300_FP8_MX_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B300_NVFP4_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B200_BF16_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B200_FP8_CS_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B200_FP8_MX_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_B200_NVFP4_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB200_BF16_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB200_FP8_CS_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB200_FP8_MX_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB200_NVFP4_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB300_BF16_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB300_FP8_CS_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB300_FP8_MX_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_GB300_NVFP4_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_H100_BF16_V1",
    "LLAMA3_8B_PRETRAIN_CONFIG_H100_FP8_CS_V1",
    # Llama3 8B SFT V1
    "LLAMA3_8B_SFT_CONFIG_GB200_BF16_V1",
    "LLAMA3_8B_SFT_CONFIG_GB200_FP8_CS_V1",
    "LLAMA3_8B_SFT_CONFIG_GB200_FP8_MX_V1",
    "LLAMA3_8B_SFT_CONFIG_H100_BF16_V1",
    "LLAMA3_8B_SFT_CONFIG_H100_FP8_CS_V1",
    "LLAMA3_8B_SFT_CONFIG_H100_FP8_MX_V1",
    # Llama3 70B SFT V1
    "LLAMA3_70B_SFT_CONFIG_GB200_BF16_V1",
    "LLAMA3_70B_SFT_CONFIG_GB200_FP8_CS_V1",
    "LLAMA3_70B_SFT_CONFIG_GB200_FP8_MX_V1",
    "LLAMA3_70B_SFT_CONFIG_H100_BF16_V1",
    "LLAMA3_70B_SFT_CONFIG_H100_FP8_CS_V1",
    "LLAMA3_70B_SFT_CONFIG_H100_FP8_MX_V1",
    "LLAMA3_70B_SFT_CONFIG_GB300_BF16_V1",
    "LLAMA3_70B_SFT_CONFIG_GB300_FP8_CS_V1",
    "LLAMA3_70B_SFT_CONFIG_GB300_FP8_MX_V1",
    # Llama3 70B LoRA V1
    "LLAMA3_70B_LORA_CONFIG_GB200_BF16_V1",
    "LLAMA3_70B_LORA_CONFIG_GB200_FP8_CS_V1",
    "LLAMA3_70B_LORA_CONFIG_GB200_FP8_MX_V1",
    "LLAMA3_70B_LORA_CONFIG_H100_BF16_V1",
    "LLAMA3_70B_LORA_CONFIG_H100_FP8_CS_V1",
    "LLAMA3_70B_LORA_CONFIG_H100_FP8_MX_V1",
    "LLAMA3_70B_LORA_CONFIG_GB300_BF16_V1",
    "LLAMA3_70B_LORA_CONFIG_GB300_FP8_CS_V1",
    "LLAMA3_70B_LORA_CONFIG_GB300_FP8_MX_V1",
]

if HAVE_MEGATRON_BRIDGE:
    __all__.extend(
        [
            "llama3_8b_pretrain_config_gb300",
            "llama3_8b_pretrain_config_gb200",
            "llama3_8b_pretrain_config_b300",
            "llama3_8b_pretrain_config_b200",
            "llama3_8b_pretrain_config_h100",
            "llama3_70b_pretrain_config_gb300",
            "llama3_70b_pretrain_config_gb200",
            "llama3_70b_pretrain_config_b300",
            "llama3_70b_pretrain_config_b200",
            "llama3_70b_pretrain_config_h100",
            "llama3_8b_sft_config_gb200",
            "llama3_8b_sft_config_h100",
            "llama3_70b_sft_config_gb200",
            "llama3_70b_sft_config_h100",
            "llama3_70b_lora_config_gb200",
            "llama3_70b_lora_config_gb300",
            "llama3_70b_lora_config_h100",
            "llama3_70b_sft_config_gb300",
            "llama31_405b_pretrain_config_gb300",
            "llama31_405b_pretrain_config_gb200",
            "llama31_405b_pretrain_config_b300",
            "llama31_405b_pretrain_config_b200",
            "llama31_405b_pretrain_config_h100",
        ]
    )
